---
title: "class08"
author: "Kiana Miyamoto"
date: "10/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
##K-means example
We will make up some data to cluster, baby steps ;-)
```{r}
# Generate some example data for clustering
tmp <- c(rnorm(30,-3), rnorm(30,3))
x <- cbind(x=tmp, y=rev(tmp))
plot(x)
```

```{r}
# k-means algorithm with 5 centers, run 20 times
k<-kmeans(x, centers=2, nstart=20)
k
```

Q. How many points are in each cluster? 30
```{r}
print(k$size)
```

Q. What ‘component’ of your result object details
 - cluster size? 30, 30
 - cluster assignment/membership? clustering vector
 - cluster center? cluster means
 
 Plot x colored by the kmeans cluster assignment and add cluster centers as blue points
```{r}
k$cluster
table(k$cluster)
plot(x, col=k$cluster)
points(k$centers, col="blue", pch=15)
```
 
## Hierarchical clustering in R

```{r}
hc<- hclust(dist(x))
hc
plot(hc)
abline(h=6,col="red")
#cutree(hc, h=6)
```

```{r}
grps<-cutree(hc,h=4)
table(grps)
```

```{r}
plot(hc)
abline(h=6, col="red")
cutree(hc,k=2)
```

```{r}
grps<-cutree(hc,h=4)
plot(x,col=grps)
grps<-cutree(hc,k=2)
plot(x,col=grps)
```


```{r}
# Step 1. Generate some example data for clustering
x <- rbind(
 matrix(rnorm(100, mean=0, sd = 0.3), ncol = 2), # c1
 matrix(rnorm(100, mean = 1, sd = 0.3), ncol = 2), # c2
 matrix(c(rnorm(50, mean = 1, sd = 0.3), # c3
 rnorm(50, mean = 0, sd = 0.3)), ncol = 2))
colnames(x) <- c("x", "y")
# Step 2. Plot the data without clustering
plot(x)
# Step 3. Generate colors for known clusters
# (just so we can compare to hclust results)
col <- as.factor( rep(c("c1","c2","c3"), each=50) )
plot(x, col=col)
```
Q. Use the dist(), hclust(), plot() and cutree()
 functions to return 2 and 3 clusters
 
```{r}
hc<-hclust(dist(x))
plot(hc)
k2<-cutree(hc,k=2)
plot(x,col=k2)
k3<-cutree(hc,k=3)
plot(x,col=k3)
```
 
Q. How does this compare to your known 'col' groups
```{r}
table(k2,col)#crosstabs
table(k3,col)
```

##How to do PCA in R
```{r}
mydata<- read.csv("https://tinyurl.com/expression-CSV",row.names=1)
head(mydata)
pca<- prcomp(t(mydata), scale=TRUE)
attributes(pca)
```

```{r}
## lets do PCA
pca <- prcomp(t(mydata), scale=TRUE)
pca$x[,1]
## A basic PC1 vs PC2 2-D plot
plot(pca$x[,1], pca$x[,2]) 

summary(pca)
```

```{r}
## Variance captured per PC
pca.var <- pca$sdev^2 
pca.var.per <- round(pca.var/sum(pca.var)*100, 1) 
pca.var.per
barplot(pca.var.per, main="Scree Plot",
 xlab="Principal Component", ylab="Percent Variation")
plot(pca) #same thing
```

```{r}
## A vector of colors for wt and ko samples
colvec <- as.factor( substr( colnames(mydata), 1, 2) )
plot(pca$x[,1], pca$x[,2], col=colvec, pch=16,
 xlab=paste0("PC1 (", pca.var.per[1], "%)"),
 ylab=paste0("PC2 (", pca.var.per[2], "%)")) 
```
